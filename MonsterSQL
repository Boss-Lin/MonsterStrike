Drop table IF EXISTS MONSTER_seq;
Drop table IF EXISTS MONSTER;
Drop table IF EXISTS TYBE;
Drop table IF EXISTS Skill_seq;
Drop table IF EXISTS Skill;
Drop table IF EXISTS LuckySkill_seq;
Drop table IF EXISTS LuckySkill;
Drop table IF EXISTS Hit;
Drop table IF EXISTS Getway;
Drop table IF EXISTS CombatType_seq;
Drop table IF EXISTS CombatType;
Drop table IF EXISTS rarity_seq;
Drop table IF EXISTS rarity;
Drop table IF EXISTS race_seq;
Drop table IF EXISTS race;
Drop table IF EXISTS type_seq;
Drop table IF EXISTS type;
DROP VIEW  IF EXISTS view_monster;

-----------------------------------------
#屬性M_tybe
CREATE TABLE TYBE (
	Tybe_no			VARCHAR(20) NOT NULL PRIMARY KEY,
    Tybe_name		VARCHAR(20) NOT NULL
);

INSERT INTO TYBE (Tybe_no, Tybe_name) VALUES ('T_1', '水屬性');
INSERT INTO TYBE (Tybe_no, Tybe_name) VALUES ('T_2', '火屬性');
INSERT INTO TYBE (Tybe_no, Tybe_name) VALUES ('T_3', '木屬性');
INSERT INTO TYBE (Tybe_no, Tybe_name) VALUES ('T_4', '光屬性');
INSERT INTO TYBE (Tybe_no, Tybe_name) VALUES ('T_5', '暗屬性');
INSERT INTO TYBE (Tybe_no, Tybe_name) VALUES ('T_6', '全屬性');

---------------------------------------------------
#反陷阱(被動)PassiveSkill
CREATE TABLE Skill_seq (
	Skill_no	INT NOT NULL AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE Skill (
	Skill_no		VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    Skill_name		VARCHAR(20) NOT NULL
);

DELIMITER $$
CREATE TRIGGER tg_Skill_insert
BEFORE INSERT ON Skill
FOR EACH ROW
BEGIN
  INSERT INTO Skill_seq VALUES (NULL);
  SET NEW.Skill_no = CONCAT('Skill', LPAD(LAST_INSERT_ID(), 2, '0'));
END$$
DELIMITER ;
INSERT INTO Skill (Skill_name) VALUES ('-');
INSERT INTO Skill (Skill_name) VALUES ('反重力護罩');
INSERT INTO Skill (Skill_name) VALUES ('反傷害壁');
INSERT INTO Skill (Skill_name) VALUES ('反傳送');
INSERT INTO Skill (Skill_name) VALUES ('飛行');
INSERT INTO Skill (Skill_name) VALUES ('掃雷者');
INSERT INTO Skill (Skill_name) VALUES ('反板塊');
INSERT INTO Skill (Skill_name) VALUES ('反風');
INSERT INTO Skill (Skill_name) VALUES ('反魔法陣');
INSERT INTO Skill (Skill_name) VALUES ('魔法陣增幅');
INSERT INTO Skill (Skill_name) VALUES ('反減速壁');

INSERT INTO Skill (Skill_name) VALUES ('超反重力護罩');
INSERT INTO Skill (Skill_name) VALUES ('超反傷害壁');
INSERT INTO Skill (Skill_name) VALUES ('超反傳送');
INSERT INTO Skill (Skill_name) VALUES ('超掃雷者');
INSERT INTO Skill (Skill_name) VALUES ('超反風');

INSERT INTO Skill (Skill_name) VALUES ('水屬性殺手');
INSERT INTO Skill (Skill_name) VALUES ('火屬性殺手');
INSERT INTO Skill (Skill_name) VALUES ('木屬性殺手');
INSERT INTO Skill (Skill_name) VALUES ('光屬性殺手');
INSERT INTO Skill (Skill_name) VALUES ('暗屬性殺手');
INSERT INTO Skill (Skill_name) VALUES ('全屬性殺手');

INSERT INTO Skill (Skill_name) VALUES ('龍族殺手');
INSERT INTO Skill (Skill_name) VALUES ('機械殺手');
INSERT INTO Skill (Skill_name) VALUES ('魔人殺手');
INSERT INTO Skill (Skill_name) VALUES ('神殺手');
INSERT INTO Skill (Skill_name) VALUES ('鳥殺手');
INSERT INTO Skill (Skill_name) VALUES ('獸族殺手');
INSERT INTO Skill (Skill_name) VALUES ('亞人殺手');
INSERT INTO Skill (Skill_name) VALUES ('魔族殺手');
INSERT INTO Skill (Skill_name) VALUES ('妖精殺手');
INSERT INTO Skill (Skill_name) VALUES ('礦物殺手');
INSERT INTO Skill (Skill_name) VALUES ('魔王殺手');
INSERT INTO Skill (Skill_name) VALUES ('幻獸殺手');
INSERT INTO Skill (Skill_name) VALUES ('宇宙族殺手');
INSERT INTO Skill (Skill_name) VALUES ('聖騎士殺手');
INSERT INTO Skill (Skill_name) VALUES ('武士殺手');
INSERT INTO Skill (Skill_name) VALUES ('同盟國殺手');
INSERT INTO Skill (Skill_name) VALUES ('軸心國殺手');
INSERT INTO Skill (Skill_name) VALUES ('幻妖殺手');
INSERT INTO Skill (Skill_name) VALUES ('使徒殺手');
INSERT INTO Skill (Skill_name) VALUES ('鬥士殺手');
INSERT INTO Skill (Skill_name) VALUES ('鬪神殺手');
INSERT INTO Skill (Skill_name) VALUES ('神獸殺手');

INSERT INTO Skill (Skill_name) VALUES ('反擊殺手');
INSERT INTO Skill (Skill_name) VALUES ('弱點殺手');
INSERT INTO Skill (Skill_name) VALUES ('重力護罩殺手');
INSERT INTO Skill (Skill_name) VALUES ('毒殺手');
INSERT INTO Skill (Skill_name) VALUES ('活力殺手');
INSERT INTO Skill (Skill_name) VALUES ('連擊殺手');
INSERT INTO Skill (Skill_name) VALUES ('雷射護罩殺手');

INSERT INTO Skill (Skill_name) VALUES ('殺手(全選)');

-----------------------
#運氣技能LuckySkill
CREATE TABLE LuckySkill_seq (
	LuckySkill_no	INT NOT NULL AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE LuckySkill (
	LuckySkill_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    LuckySkill_name		VARCHAR(20) NOT NULL
);

DELIMITER $$
CREATE TRIGGER tg_LuckySkill_insert
BEFORE INSERT ON LuckySkill
FOR EACH ROW
BEGIN
  INSERT INTO LuckySkill_seq VALUES (NULL);
  SET NEW.LuckySkill_no = CONCAT('LuckySkill', LPAD(LAST_INSERT_ID(), 4, '0'));
END$$
DELIMITER ;

INSERT INTO LuckySkill (LuckySkill_name) VALUES ('關鍵傷害');
INSERT INTO LuckySkill (LuckySkill_name) VALUES ('護盾');
INSERT INTO LuckySkill (LuckySkill_name) VALUES ('引導');

-----------------------------------------------
#擊種Hit
CREATE TABLE Hit (
	Hit_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    Hit_name		VARCHAR(20) NOT NULL
);

INSERT INTO Hit (Hit_no, Hit_name) VALUES ('Hit01', '反射');
INSERT INTO Hit (Hit_no, Hit_name) VALUES ('Hit02', '貫通');

-----------------------------------------------
#取得方式
CREATE TABLE Getway (
	Get_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    Get_name		VARCHAR(20) NOT NULL
);

INSERT INTO Getway (Get_no, Get_name) VALUES ('Get01', '轉蛋');
INSERT INTO Getway (Get_no, Get_name) VALUES ('Get02', '冒險掉落');
-----------------------------------------------
#戰型CombatType
CREATE TABLE CombatType_seq (
	CombatType_no	INT NOT NULL AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE CombatType (
	CombatType_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    CombatType_name		VARCHAR(20) NOT NULL
);

DELIMITER $$
CREATE TRIGGER tg_CombatType_insert
BEFORE INSERT ON CombatType
FOR EACH ROW
BEGIN
  INSERT INTO CombatType_seq VALUES (NULL);
  SET NEW.CombatType_no = CONCAT('CombatType', LPAD(LAST_INSERT_ID(), 4, '0'));
END$$
DELIMITER ;

INSERT INTO CombatType (CombatType_name) VALUES ('全部');
INSERT INTO CombatType (CombatType_name) VALUES ('平衡型');
INSERT INTO CombatType (CombatType_name) VALUES ('力量型');
INSERT INTO CombatType (CombatType_name) VALUES ('速度型');
INSERT INTO CombatType (CombatType_name) VALUES ('砲擊型');

-----------------------------------------------
#稀有度rarity
CREATE TABLE rarity_seq (
	rarity_no	INT NOT NULL AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE rarity (
	rarity_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    rarity_name		VARCHAR(20) NOT NULL
);

INSERT INTO rarity (rarity_no, rarity_name) VALUES ('rarity01', '五星');
INSERT INTO rarity (rarity_no, rarity_name) VALUES ('rarity02', '六星');

-----------------------------------------------
#種族race
CREATE TABLE race_seq (
	race_no	INT NOT NULL AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE race (
	race_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    race_name		VARCHAR(20) NOT NULL
);

DELIMITER $$
CREATE TRIGGER tg_race_insert
BEFORE INSERT ON race
FOR EACH ROW
BEGIN
  INSERT INTO race_seq VALUES (NULL);
  SET NEW.race_no = CONCAT('race', LPAD(LAST_INSERT_ID(), 4, '0'));
END$$
DELIMITER ;

INSERT INTO race (race_name) VALUES ('龍');
INSERT INTO race (race_name) VALUES ('機械');
INSERT INTO race (race_name) VALUES ('魔人');
INSERT INTO race (race_name) VALUES ('神');
INSERT INTO race (race_name) VALUES ('鳥');
INSERT INTO race (race_name) VALUES ('獸');
INSERT INTO race (race_name) VALUES ('亞人');
INSERT INTO race (race_name) VALUES ('魔族');
INSERT INTO race (race_name) VALUES ('妖精');
INSERT INTO race (race_name) VALUES ('礦物');
INSERT INTO race (race_name) VALUES ('魔王');
INSERT INTO race (race_name) VALUES ('幻獸');
INSERT INTO race (race_name) VALUES ('外星');
INSERT INTO race (race_name) VALUES ('宇宙');
INSERT INTO race (race_name) VALUES ('聖騎士');
INSERT INTO race (race_name) VALUES ('武士');
INSERT INTO race (race_name) VALUES ('同盟國');
INSERT INTO race (race_name) VALUES ('軸心國');
INSERT INTO race (race_name) VALUES ('幻妖');
INSERT INTO race (race_name) VALUES ('EVA駕駛員');
INSERT INTO race (race_name) VALUES ('使徒');
INSERT INTO race (race_name) VALUES ('鬥士');
INSERT INTO race (race_name) VALUES ('妖怪');
INSERT INTO race (race_name) VALUES ('青銅聖鬥士');
INSERT INTO race (race_name) VALUES ('黃金聖鬥士');
INSERT INTO race (race_name) VALUES ('鬪神');
INSERT INTO race (race_name) VALUES ('神獸');
INSERT INTO race (race_name) VALUES ('聖域獵人');
INSERT INTO race (race_name) VALUES ('人造人');
INSERT INTO race (race_name) VALUES ('怪異');
INSERT INTO race (race_name) VALUES ('巨人');
INSERT INTO race (race_name) VALUES ('魔神');
INSERT INTO race (race_name) VALUES ('人偶');
INSERT INTO race (race_name) VALUES ('嵌合蟻');
INSERT INTO race (race_name) VALUES ('米奇與好朋友');
INSERT INTO race (race_name) VALUES ('死神');
INSERT INTO race (race_name) VALUES ('燃燒者');
INSERT INTO race (race_name) VALUES ('BORDER隊員');
INSERT INTO race (race_name) VALUES ('近界民');
INSERT INTO race (race_name) VALUES ('十刃');
INSERT INTO race (race_name) VALUES ('假面軍勢');

-----------------------------------------------
#進化狀態type
CREATE TABLE type_seq (
	type_no	INT NOT NULL AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE type (
	type_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    type_name		VARCHAR(20) NOT NULL
);

DELIMITER $$
CREATE TRIGGER tg_type_insert
BEFORE INSERT ON type
FOR EACH ROW
BEGIN
  INSERT INTO type_seq VALUES (NULL);
  SET NEW.type_no = CONCAT('type', LPAD(LAST_INSERT_ID(), 4, '0'));
END$$
DELIMITER ;

INSERT INTO type (type_name) VALUES ('進化');
INSERT INTO type (type_name) VALUES ('神化');
INSERT INTO type (type_name) VALUES ('獸神化');
INSERT INTO type (type_name) VALUES ('獸神化．改');

---------------------------------------------------
#怪物圖鑑
CREATE TABLE MONSTER_seq (
	M_no	INT NOT NULL AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE MONSTER (
	M_no			VARCHAR(20) NOT NULL PRIMARY KEY DEFAULT '0',
    M_name			VARCHAR(20) NOT NULL,
    M_pic			BLOB ,
    M_tybe			VARCHAR(20) NOT NULL,
    Skill_A1		VARCHAR(20),
    Skill_A2		VARCHAR(20),
    Skill_A3		VARCHAR(20),
    Skill_A4		VARCHAR(20),
    Skill_B1		VARCHAR(20),
    Skill_B2		VARCHAR(20),
    Skill_B3		VARCHAR(20),
    Skill_B4		VARCHAR(20),
    Skill_C1		VARCHAR(20),
    Skill_C2		VARCHAR(20),
    M_luckySkill	VARCHAR(20) NOT NULL,
    M_hit			VARCHAR(20) NOT NULL,
    M_combatType	VARCHAR(20) NOT NULL,
    M_rarity		VARCHAR(20) NOT NULL,
    M_race 			VARCHAR(20) NOT NULL,
    M_ftuit			VARCHAR(20),
    M_type			VARCHAR(20) NOT NULL,
    M_friendskill1	VARCHAR(20) NOT NULL,
    M_friendskill2	VARCHAR(20),
    M_get			VARCHAR(20) NOT NULL,
	M_spec			TEXT,
    M_pool			TEXT,
    
    M_createtime	TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
    M_updatetime	TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,
   
    FOREIGN KEY (M_tybe) REFERENCES TYBE (Tybe_no),
    FOREIGN KEY (M_luckySkill) REFERENCES LuckySkill (LuckySkill_no),
    FOREIGN KEY (M_hit) REFERENCES Hit (Hit_no),
    FOREIGN KEY (M_combatType) REFERENCES CombatType (CombatType_no),
    FOREIGN KEY (M_rarity) REFERENCES rarity (rarity_no),
    FOREIGN KEY (M_race) REFERENCES race (race_no),
    FOREIGN KEY (M_type) REFERENCES type (type_no),
    FOREIGN KEY (M_get) REFERENCES Getway (Get_no)
);

DELIMITER $$
CREATE TRIGGER tg_MONSTER_insert
BEFORE INSERT ON MONSTER
FOR EACH ROW
BEGIN
  INSERT INTO MONSTER_seq VALUES (NULL);
  SET NEW.M_no = CONCAT('No.', LPAD(LAST_INSERT_ID(), 4, '0'));
END$$
DELIMITER ;

INSERT INTO `monsterstrike`.`monster` (
`M_name`, `M_tybe`, `Skill_A1`, `Skill_A2`, `Skill_A3`, `Skill_A4`, `Skill_B1`, `Skill_B2`, `Skill_B3`, `Skill_B4`, `Skill_C1`, `Skill_C2`, `M_luckySkill`, `M_hit`, `M_combatType`, `M_rarity`, `M_race`, `M_ftuit`, `M_type`, `M_friendskill1`, `M_friendskill2`, 
`M_get`, `M_spec`, `M_pool`)
VALUES (
'水柱 冨岡義勇', 'T_1', 'Skill12', 'Skill09', 'Skill01', 'Skill01', 'Skill07', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01','LuckySkill0002', 'Hit01', 'CombatType0002', 'rarity02', 'race0007', '有', 'type0003', '三叉雷射 EL', '長橫斬刃', 'Get01', '超強', '鬼滅之刃'
);

INSERT INTO `monsterstrike`.`monster` (
`M_name`, `M_tybe`, `Skill_A1`, `Skill_A2`, `Skill_A3`, `Skill_A4`, `Skill_B1`, `Skill_B2`, `Skill_B3`, `Skill_B4`, `Skill_C1`, `Skill_C2`, `M_luckySkill`, `M_hit`, `M_combatType`, `M_rarity`, `M_race`, `M_ftuit`, `M_type`, `M_friendskill1`, `M_friendskill2`, 
`M_get`, `M_spec`, `M_pool`)
VALUES (
'帶來親和的慈愛天使 瑪娜', 'T_2', 'Skill15', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01','LuckySkill0002', 'Hit01', 'CombatType0004', 'rarity02', 'race0015', '有', 'type0003', '漸伸線領域・More', '漸伸線領域・Narrow', 'Get01', '超強', 'DX精選卡池'
);

INSERT INTO `monsterstrike`.`monster` (
`M_name`, `M_tybe`, `Skill_A1`, `Skill_A2`, `Skill_A3`, `Skill_A4`, `Skill_B1`, `Skill_B2`, `Skill_B3`, `Skill_B4`, `Skill_C1`, `Skill_C2`, `M_luckySkill`, `M_hit`, `M_combatType`, `M_rarity`, `M_race`, `M_ftuit`, `M_type`, `M_friendskill1`, `M_friendskill2`, 
`M_get`, `M_spec`, `M_pool`)
VALUES (
'黑衣的復仇者 酷拉皮卡', 'T_3', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01','LuckySkill0001', 'Hit02', 'CombatType0002', 'rarity02', 'race0007', '有', 'type0003', '狂亂雷射 EL', '速度提升', 'Get01', '超強', '獵人'
);

INSERT INTO `monsterstrike`.`monster` (
`M_name`, `M_tybe`, `Skill_A1`, `Skill_A2`, `Skill_A3`, `Skill_A4`, `Skill_B1`, `Skill_B2`, `Skill_B3`, `Skill_B4`, `Skill_C1`, `Skill_C2`, `M_luckySkill`, `M_hit`, `M_combatType`, `M_rarity`, `M_race`, `M_ftuit`, `M_type`, `M_friendskill1`, `M_friendskill2`, 
`M_get`, `M_spec`, `M_pool`)
VALUES (
'波雷波雷國的「救世神」 歐娘庫彭', 'T_4', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'LuckySkill0003', 'Hit02', 'CombatType0003', 'rarity02', 'race0004', '有', 'type0003', '通弱點鎖定衝擊波 5', '超強血族脈衝', 
'Get01', '超強', '激獸神'
);

INSERT INTO `monsterstrike`.`monster` (
`M_name`, `M_tybe`, `Skill_A1`, `Skill_A2`, `Skill_A3`, `Skill_A4`, `Skill_B1`, `Skill_B2`, `Skill_B3`, `Skill_B4`, `Skill_C1`, `Skill_C2`, `M_luckySkill`, `M_hit`, `M_combatType`, `M_rarity`, `M_race`, `M_ftuit`, `M_type`, `M_friendskill1`, `M_friendskill2`, 
`M_get`, `M_spec`, `M_pool`)
VALUES (
'怪盜亞森：魅影模式', 'T_5','Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'Skill01', 'LuckySkill0002', 'Hit02', 'CombatType0005', 'rarity02', 'race0007', '有', 'type0003', '力量驅動', '印記炸彈', 
'Get01', '超強', '超獸神'
);

---------------------------------------------------
#View表 技能擁有
CREATE OR REPLACE VIEW view_monster (
M_no, Name, M_pic, Tybe, 
PassiveSkill_1, PassiveSkill_2, PassiveSkill_3, PassiveSkill_4, 
EnergySkill_1, EnergySkill_2, EnergySkill_3, EnergySkill_4, 
InvolvedSkill_1, InvolvedSkill_2, 
LuckySkill, 
Hit, CombatType, Rarity, Race, Ftuit, Type, friendskill1, friendskill2, Get_name, Spec, Pool, Createtime, Updatetime) AS
SELECT 
M_no, M_name, a.M_pic, b.Tybe_name, 
c.skill_name,  d.skill_name, e.skill_name, f.skill_name, 
g.skill_name, h.skill_name, i.skill_name, j.skill_name, 
k.skill_name, l.skill_name, 
m.LuckySkill_name,
n.hit_name, o.combatType_name, p.rarity_name, q.race_name, a.M_ftuit, r.type_name, a.M_friendskill1, a.M_friendskill2, s.get_name, a.M_spec, a.M_pool, a.M_createtime, a.M_updatetime
FROM monster a
INNER JOIN tybe b 		ON a.M_tybe = b.Tybe_no
INNER JOIN skill c 		ON a.Skill_A1 = c.skill_no
INNER JOIN skill d 		ON a.Skill_A2 = d.skill_no
INNER JOIN skill e 		ON a.Skill_A3 = e.skill_no
INNER JOIN skill f 		ON a.Skill_A4 = f.skill_no

INNER JOIN skill g 		ON a.Skill_B1 = g.skill_no
INNER JOIN skill h 		ON a.Skill_B2 = h.skill_no
INNER JOIN skill i 		ON a.Skill_B3 = i.skill_no
INNER JOIN skill j 		ON a.Skill_B4 = j.skill_no

INNER JOIN skill k 		ON a.Skill_C1 = k.skill_no
INNER JOIN skill l 		ON a.Skill_C2 = l.skill_no

INNER JOIN luckyskill m ON a.M_luckySkill = m.LuckySkill_no
INNER JOIN hit n 		ON a.M_hit = n.Hit_no
INNER JOIN combattype o ON a.M_combatType = o.CombatType_no
INNER JOIN rarity p 	ON a.M_rarity = p.rarity_no
INNER JOIN race q 		ON a.M_race = q.race_no
INNER JOIN type r 		ON a.M_type = r.type_no
INNER JOIN getway s 	ON a.M_get = s.get_no

-- GROUP BY
order by M_no asc 
-- WHERE 
;
